/**
 * @file s21_is_equal.c
 * @brief Реализация функции проверки равенства decimal чисел
 * @details Сравнивает два decimal числа с учетом знака, масштаба и значения
 */

#include <stdint.h>  // Типы фиксированной ширины

#include "s21_decimal.h"

#define U32 uint32_t  // Сокращение для 32-битного беззнакового типа

/**
 * @brief Проверить, равны ли два decimal числа
 * @param a Первое число
 * @param b Второе число
 * @return 1 если числа равны, 0 если не равны
 * @details Особые случаи:
 *          - Если оба числа равны нулю, они считаются равными независимо от
 * знака
 *          - Удаляются незначащие нули перед сравнением
 *          - Числа равны только если у них одинаковые знак, масштаб и мантисса
 */
int s21_is_equal(s21_decimal a, s21_decimal b) {
  int result = 0;

  // Проверяем, не равны ли оба числа нулю
  if (!s21_is_zero(&a) || !s21_is_zero(&b)) {
    // Хотя бы одно число не равно нулю

    if (s21_get_sign(&a) == s21_get_sign(&b)) {
      // Знаки одинаковые - можем сравнивать значения

      s21_strip_trailing_zeros(&a);  // Удаляем незначащие нули у первого числа
      s21_strip_trailing_zeros(&b);  // Удаляем незначащие нули у второго числа

      // Числа равны, если одинаковые масштаб и все биты мантиссы
      result =
          (s21_get_scale(&a) == s21_get_scale(&b) && a.bits[0] == b.bits[0] &&
           a.bits[1] == b.bits[1] && a.bits[2] == b.bits[2]);
    } else {
      // Знаки разные - числа не равны
      result = 0;
    }
  } else {
    // Оба числа равны нулю - они равны независимо от знака
    result = 1;
  }

  return result;
}
