# Документация библиотеки s21_decimal

## Обзор

Библиотека `s21_decimal` предоставляет реализацию типа данных decimal для языка C, аналогичного типу decimal в C#. Этот тип данных предназначен для высокоточных вычислений с десятичными числами, особенно важных в финансовых приложениях.

## Структура decimal

```c
typedef struct {
    int bits[4];  // 128-битное представление числа
} s21_decimal;
```

- `bits[0-2]` - 96-битная мантисса (значение числа)
- `bits[3]` - метаданные:
  - Биты 0-15: не используются (должны быть 0)
  - Биты 16-23: масштаб (от 0 до 28)
  - Биты 24-30: не используются (должны быть 0) 
  - Бит 31: знак (0 - положительное, 1 - отрицательное)

## Функции библиотеки

### Арифметические операции

| Функция | Описание | Коды возврата |
|---------|----------|---------------|
| `s21_add` | Сложение двух decimal чисел | 0 - успех, 1 - слишком большое, 2 - слишком маленькое |
| `s21_sub` | Вычитание двух decimal чисел | 0 - успех, 1 - слишком большое, 2 - слишком маленькое |
| `s21_mul` | Умножение двух decimal чисел | 0 - успех, 1 - слишком большое, 2 - слишком маленькое |
| `s21_div` | Деление двух decimal чисел | 0 - успех, 1 - слишком большое, 2 - слишком маленькое, 3 - деление на ноль |

### Функции сравнения

| Функция | Описание | Возвращаемое значение |
|---------|----------|----------------------|
| `s21_is_less` | Проверка a < b | 1 если true, 0 если false |
| `s21_is_less_or_equal` | Проверка a ≤ b | 1 если true, 0 если false |
| `s21_is_greater` | Проверка a > b | 1 если true, 0 если false |
| `s21_is_greater_or_equal` | Проверка a ≥ b | 1 если true, 0 если false |
| `s21_is_equal` | Проверка a = b | 1 если true, 0 если false |
| `s21_is_not_equal` | Проверка a ≠ b | 1 если true, 0 если false |

### Функции конвертации

| Функция | Описание | Коды возврата |
|---------|----------|---------------|
| `s21_from_int_to_decimal` | Конвертация int → decimal | 0 - успех, 1 - ошибка |
| `s21_from_float_to_decimal` | Конвертация float → decimal | 0 - успех, 1 - ошибка |
| `s21_from_decimal_to_int` | Конвертация decimal → int | 0 - успех, 1 - ошибка |
| `s21_from_decimal_to_float` | Конвертация decimal → float | 0 - успех, 1 - ошибка |

### Функции округления

| Функция | Описание | Коды возврата |
|---------|----------|---------------|
| `s21_floor` | Округление к отрицательной бесконечности | 0 - успех, 1 - ошибка |
| `s21_round` | Банковское округление до ближайшего целого | 0 - успех, 1 - ошибка |
| `s21_truncate` | Отбрасывание дробной части | 0 - успех, 1 - ошибка |
| `s21_negate` | Изменение знака числа | 0 - успех, 1 - ошибка |

## Особенности реализации

### Банковское округление

Библиотека использует банковское округление (округление к четному):
- Если остаток меньше 5 - округляем вниз
- Если остаток больше 5 - округляем вверх
- Если остаток равен 5 - округляем к четному числу

### Масштабирование

Все операции автоматически приводят числа к общему масштабу для корректных вычислений. При переполнении масштаб может быть уменьшен с применением банковского округления.

### Обработка ошибок

Функции возвращают коды ошибок для различных ситуаций:
- Переполнение (результат слишком большой)
- Недополнение (результат слишком маленький)
- Деление на ноль
- Некорректные входные данные

## Примеры использования

```c
#include "s21_decimal.h"

int main() {
    s21_decimal a, b, result;
    
    // Создание чисел из int
    s21_from_int_to_decimal(123, &a);
    s21_from_int_to_decimal(456, &b);
    
    // Сложение
    if (s21_add(a, b, &result) == 0) {
        printf("Сложение выполнено успешно\n");
    }
    
    // Создание чисел из float
    s21_from_float_to_decimal(3.14f, &a);
    s21_from_float_to_decimal(2.86f, &b);
    
    // Умножение
    if (s21_mul(a, b, &result) == 0) {
        printf("Умножение выполнено успешно\n");
    }
    
    return 0;
}
```

## Сборка проекта

```bash
# Сборка библиотеки
make

# Запуск тестов
make test

# Генерация отчета о покрытии кода
make coverage

# Очистка временных файлов
make clean
```

## Структура проекта

```
src/
├── s21_decimal.h          # Заголовочный файл библиотеки
├── s21_add.c              # Функция сложения
├── s21_sub.c              # Функция вычитания
├── s21_mul.c              # Функция умножения
├── s21_div.c              # Функция деления
├── s21_is_*.c             # Функции сравнения
├── s21_from_*.c           # Функции конвертации
├── s21_floor.c            # Функции округления
├── s21_round.c
├── s21_truncate.c
├── s21_negate.c
├── s21_utilities.c        # Вспомогательные функции
├── tests/                 # Юнит-тесты
│   ├── tests.h
│   ├── tests.c
│   └── tests_*.c
└── Makefile              # Файл сборки
```